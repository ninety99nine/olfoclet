"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[3803],{93584:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(58222),n={class:"w-full bg-gray-200 rounded-full"};const l={props:{width:{type:Number,default:0}}};const s=(0,r(83744).Z)(l,[["render",function(e,t,r,l,s,i){return(0,o.openBlock)(),(0,o.createElementBlock)("div",n,[(0,o.createElementVNode)("div",{class:"bg-blue-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full",style:(0,o.normalizeStyle)({width:r.width+"%"})},(0,o.toDisplayString)(r.width)+"%",5)])}]])},53803:(e,t,r)=>{r.r(t),r.d(t,{default:()=>R});var o=r(58222),n=(0,o.createElementVNode)("span",{class:"block text-justify"},[(0,o.createTextVNode)(" Select a previously exported "),(0,o.createElementVNode)("span",{class:"font-semibold text-blue-500"},"Project File"),(0,o.createTextVNode)(" to begin importing the project. Note that this import process will replace your current version's screens, displays, events, settings e.t.c. After you import any Project File you must "),(0,o.createElementVNode)("span",{class:"font-semibold text-green-500"},"Save Changes"),(0,o.createTextVNode)(" to finalize the process. This will permanently update the changes. If the JSON file imported is very large, it may take some time to save changes. ")],-1),l=(0,o.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,o.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1),s=(0,o.createElementVNode)("span",{class:"text-xs text-gray-400"},"Select the exported JSON File",-1),i={key:0,class:"flex justify-between border rounded-md p-2 mt-2"},a={class:"flex"},c=(0,o.createElementVNode)("div",{class:"mr-2"},[(0,o.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"text-blue-400 h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,o.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})])],-1),u={class:"text-gray-700 mb-1"},d={class:"text-gray-500 text-xs"},p=(0,o.createElementVNode)("span",{class:"text-gray-300 italic"}," â€” application/json",-1),m=[(0,o.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)],f={key:1},h=(0,o.createElementVNode)("h1",{class:"text-gray-700 text-xs font-semibold my-4"},"Properties To Import",-1),g={class:"grid grid-cols-2 bg-blue-50 p-4 rounded-md"},v=["id","onUpdate:modelValue"],y=["for"],w={class:"grid grid-cols-12 gap-8 justify-center mb-4"},b={class:"col-span-8"},x={class:"col-span-4 flex items-center justify-end"},k=[(0,o.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,o.createElementVNode)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),(0,o.createElementVNode)("span",null,"Cancel",-1)],V=(0,o.createElementVNode)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor"},[(0,o.createElementVNode)("path",{"fill-rule":"evenodd",d:"M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),N=(0,o.createElementVNode)("span",null,"Import",-1);var E=r(24788),P=r(90770),B=r(75802),C=r(91098),S=r(72864),j=r(55092),O=r(93584);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==D(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==D(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===D(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const I={props:["form"],components:{DefaultError:E.Z,PrimaryAlert:P.Z,DefaultModal:B.Z,DefaultButton:S.Z,PrimaryButton:j.Z,DefaultProgressBar:O.Z},data:function(){return{file:null,error:null,fileList:[],builder:null,request:null,properties:[],isLoading:!1,uploadMessage:null,progressPercentage:null,uploadProgressPercentage:null,downloadProgressPercentage:null,useVersionBuilder:(0,C.P)()}},methods:{beforeUpload:function(e){this.reset();var t=e.raw;if("application/json"==t.type){this.file=t;var r=new FileReader;r.onload=function(e){try{var t=JSON.parse(e.target.result),r=Object.keys(t);r.includes("screens")&&r.includes("simulator")?(this.builder=t,this.properties=r.map((function(e){return{label:e.split("_").join(" "),value:e,checked:!0}}))):this.setImportError("The file imported is not a valid Builder File")}catch(e){this.reset(),this.setImportError("Failed to process the file")}}.bind(this),this.file&&r.readAsText(this.file)}else this.setImportError("The file imported is not a valid JSON File")},reset:function(){this.file=null,this.fileList=[],this.builder=null,this.properties=[],this.unsetImportError()},setImportError:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.error=t,setTimeout((function(){e.unsetImportError()}),3e3)},unsetImportError:function(){this.error=""},getFileSize:function(e){var t=1024,r=1048576;return(e=parseInt(e))>=r?e=Math.round(e/r*100)/100+" MB":e>=t&&(e=Math.round(e/t*100)/100+" KB"),e},importFile:function(e){if(this.builder){for(var t=this.properties.map((function(e){return e.value})),r=this.properties.filter((function(e){return 0==e.checked})).map((function(e){return e.value})),o=0;o<t.length;o++){var n=t[o];r.includes(n)&&delete this.builder[n]}var l=M(M({},this.useVersionBuilder.builder),this.builder);this.uploadToRepairFile(l,e)}else this.setImportError("Select a JSON File to upload")},uploadToRepairFile:function(e,t){var r=this;this.isLoading=!0,console.log("builderForRepair"),console.log(e);var n=new FormData;n.append("builder",JSON.stringify(e));var l=route("version.repair",{project:this.route().params.project,app:this.route().params.app,version:this.route().params.version}),s=axios.CancelToken.source();this.request={cancel:s.cancel};var i={onUploadProgress:function(e){r.uploadMessage="Uploading file for repair analysis",r.uploadProgressPercentage=Math.round(100*e.loaded/e.total),r.calculateProgress()},onDownloadProgress:function(e){r.uploadMessage="Downloading repaired file",r.downloadProgressPercentage=Math.round(100*e.loaded/e.total),r.calculateProgress()},cancelToken:s.token},a=this;axios.post(l,n,i).then((function(e){var n=e.data;a.useVersionBuilder.setBuilder(n),r.useVersionBuilder.selectRecomendedScreen(),r.useVersionBuilder.hasImportedBuilder=!0,a.$message({type:"success",message:(0,o.h)("p",null,[(0,o.h)("span",null,"Import successful"),(0,o.h)("div",{class:"text-xs mt-2"},"The builder was imported successfully."),(0,o.h)("div",{class:"text-xs mt-2"},'Click "Save Changes" to permanently save these updates. Refresh the page to undo the import.')]),duration:8e3}),t()})).catch((function(e){var t,o=null!==(t=(e||{}).message)&&void 0!==t?t:"Sorry, something went wrong";419===e.response.status&&(o="Please login",r.$inertia.get(route("login.show"))),a.$message({message:o,type:"warning"})})).finally((function(){r.resetRequest()}))},calculateProgress:function(){var e=(this.uploadProgressPercentage||0)+(this.downloadProgressPercentage||0);this.progressPercentage=Math.round(100*e/200)},cancelRequest:function(){this.request&&this.request.cancel("File repair cancelled"),this.resetRequest()},resetRequest:function(){this.request=null,this.isLoading=!1,this.uploadMessage=null,this.progressPercentage=null,this.uploadProgressPercentage=null,this.downloadProgressPercentage=null}}};const R=(0,r(83744).Z)(I,[["render",function(e,t,r,E,P,B){var C=(0,o.resolveComponent)("PrimaryAlert"),S=(0,o.resolveComponent)("DefaultButton"),j=(0,o.resolveComponent)("el-upload"),O=(0,o.resolveComponent)("DefaultProgressBar"),D=(0,o.resolveComponent)("DefaultError"),F=(0,o.resolveComponent)("DefaultModal");return(0,o.openBlock)(),(0,o.createBlock)(F,{onOpen:t[2]||(t[2]=function(e){return B.reset()}),defaultText:"Cancel",primaryAction:B.importFile,primaryText:r.form.processing?"":"Import"},{title:(0,o.withCtx)((function(){return[(0,o.createTextVNode)("Import Version")]})),trigger:(0,o.withCtx)((function(){return[(0,o.createVNode)(S,{class:"rounded-r-none"},{default:(0,o.withCtx)((function(){return[V,N]})),_:1})]})),default:(0,o.withCtx)((function(){return[(0,o.createVNode)(C,{class:"mb-4"},{default:(0,o.withCtx)((function(){return[n]})),_:1}),null==P.progressPercentage?((0,o.openBlock)(),(0,o.createElementBlock)(o.Fragment,{key:0},[(0,o.createVNode)(j,{action:"/",multiple:!1,"auto-upload":!1,"file-list":P.fileList,"on-change":B.beforeUpload},(0,o.createSlots)({default:(0,o.withCtx)((function(){return[(0,o.createVNode)(S,{class:"px-3 mr-2"},{default:(0,o.withCtx)((function(){return[l,(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(P.file?"Replace":"Select")+" File",1)]})),_:1})]})),_:2},[P.file?void 0:{name:"tip",fn:(0,o.withCtx)((function(){return[s]})),key:"0"}]),1032,["file-list","on-change"]),P.file?((0,o.openBlock)(),(0,o.createElementBlock)("div",i,[(0,o.createElementVNode)("div",a,[c,(0,o.createElementVNode)("div",null,[(0,o.createElementVNode)("p",u,(0,o.toDisplayString)(P.file.name),1),(0,o.createElementVNode)("span",d,[(0,o.createElementVNode)("span",null,(0,o.toDisplayString)(B.getFileSize(P.file.size)),1),p])])]),((0,o.openBlock)(),(0,o.createElementBlock)("svg",{onClick:t[0]||(t[0]=function(e){return B.reset()}),xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 cursor-pointer text-gray-400 hover:text-red-500 active:text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},m))])):(0,o.createCommentVNode)("",!0),P.file?((0,o.openBlock)(),(0,o.createElementBlock)("div",f,[h,(0,o.createElementVNode)("div",g,[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(P.properties,(function(e,t){return(0,o.openBlock)(),(0,o.createElementBlock)("div",{key:t,class:"col-span-1"},[(0,o.withDirectives)((0,o.createElementVNode)("input",{id:"property-checkbox-"+t,type:"checkbox","onUpdate:modelValue":function(t){return e.checked=t},class:"w-4 h-4 mr-2 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"},null,8,v),[[o.vModelCheckbox,e.checked]]),(0,o.createElementVNode)("label",{for:"property-checkbox-"+t},(0,o.toDisplayString)(e.label),9,y)])})),128))])])):(0,o.createCommentVNode)("",!0)],64)):((0,o.openBlock)(),(0,o.createBlock)(o.Transition,{key:1,name:"slide-up"},{default:(0,o.withCtx)((function(){return[(0,o.createElementVNode)("div",w,[(0,o.createElementVNode)("div",b,[(0,o.createVNode)(O,{width:P.progressPercentage},null,8,["width"])]),(0,o.createElementVNode)("div",x,[(0,o.createElementVNode)("span",{onClick:t[1]||(t[1]=function(e){return B.cancelRequest()}),class:"flex items-center text-xs text-red-500 hover:text-red-600 active:text-red-700 cursor-pointer ml-8"},k)])])]})),_:1})),P.error?((0,o.openBlock)(),(0,o.createBlock)(D,{key:2,error:P.error,class:"mt-2"},null,8,["error"])):(0,o.createCommentVNode)("",!0)]})),_:1},8,["primaryAction","primaryText"])}]])}}]);